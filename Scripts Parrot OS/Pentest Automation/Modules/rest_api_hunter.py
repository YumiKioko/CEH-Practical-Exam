import requests

def run(target, output_file):
    print(f"üîé [REST API] Ca√ßando endpoints em {target}...")

    common_paths = [
        "/api/",
        "/api/v1/",
        "/v1/",
        "/v2/",
        "/api/users",
        "/api/login",
        "/api/auth",
        "/api/admin"
    ]

    found = []

    try:
        with open(output_file, "w") as f:
            for path in common_paths:
                url = f"http://{target}{path}"
                try:
                    response = requests.get(url, timeout=5)
                    if response.status_code in [200, 401, 403]:  # 401/403 indicam algo protegido
                        f.write(f"[+] Poss√≠vel REST endpoint: {url} ({response.status_code})\n")
                        found.append(url)
                except requests.exceptions.RequestException:
                    continue

            if not found:
                f.write("[-] Nenhum REST endpoint encontrado.\n")

    except Exception as e:
        print(f"‚ùå Erro na busca de REST API: {e}")
