import requests

def run(target, output_file):
    print(f"üîé [OpenAPI/Swagger] Tentando descobrir documenta√ß√£o em {target}...")

    swagger_paths = [
        "/swagger.json",
        "/swagger/v1/swagger.json",
        "/v2/api-docs",
        "/openapi.json",
        "/api-docs"
    ]

    found = False

    try:
        with open(output_file, "w") as f:
            for path in swagger_paths:
                url = f"http://{target}{path}"
                try:
                    response = requests.get(url, timeout=5)
                    if response.status_code == 200 and ("swagger" in response.text or "openapi" in response.text):
                        f.write(f"[+] Documenta√ß√£o OpenAPI encontrada: {url}\n")
                        found = True
                except requests.exceptions.RequestException:
                    continue

            if not found:
                f.write("[-] Nenhuma documenta√ß√£o OpenAPI/Swagger encontrada.\n")

    except Exception as e:
        print(f"‚ùå Erro na busca de OpenAPI: {e}")
