import requests

def run(target, output_file):
    print(f"üîé [GraphQL] Buscando endpoints em {target}...")

    potential_paths = [
        "/graphql",
        "/api/graphql",
        "/graphiql"
    ]

    found = False

    try:
        with open(output_file, "w") as f:
            for path in potential_paths:
                url = f"http://{target}{path}"
                try:
                    response = requests.post(url, json={"query":"{__schema{types{name}}}"}, timeout=5)
                    if response.status_code in [200, 400]:  # 400 pode indicar GraphQL v√°lido sem introspection
                        f.write(f"[+] Poss√≠vel GraphQL encontrado: {url}\n")
                        found = True
                except requests.exceptions.RequestException:
                    continue

            if not found:
                f.write("[-] Nenhum endpoint GraphQL encontrado.\n")

    except Exception as e:
        print(f"‚ùå Erro na busca de GraphQL: {e}")
