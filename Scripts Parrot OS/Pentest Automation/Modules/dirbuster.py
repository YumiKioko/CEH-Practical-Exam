import subprocess

def run(target, output_file):
    print(f"📂 [Dirbuster] Buscando diretórios ocultos em {target}...")
    try:
        wordlist = "/usr/share/wordlists/dirb/common.txt"  # Pode personalizar
        command = f"dirsearch -u http://{target} -w {wordlist} --plain-text-report={output_file}"
        subprocess.run(command, shell=True)
        print(f"✅ Busca de diretórios finalizada")
    except Exception as e:
        print(f"❌ Erro no dirbuster: {e}")
